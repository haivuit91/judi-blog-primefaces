<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="./templateAdmin.xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html">

    <ui:define name="content">
        <f:view>
            <p:growl id="growl" life="2000" showDetail="true"/>
            <h:form>
                <p:commandButton value="New Project" id="selectButton" update=":formCreate" oncomplete="PF('createProject').show()" icon="ui-icon-heart" title="Creater" styleClass="ui-priority-primary" >
                    <f:setPropertyActionListener value="#{project}" target="#{projectBean.project}"/>
                </p:commandButton> 
            </h:form>
            <h:form id="formDataTable">
                <p:dataTable value="#{projectBean.allProject}" var="projectList" rows="6" id="dataTables"  paginator="true"
                             paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                             rowsPerPageTemplate="5,10,15"
                             widgetVar="projectsTable" paginatorPosition="bottom" 
                             emptyMessage="No cars found with given criteria" filteredValue="#{projectBean.filteredProjects}">
                    <f:facet name="header" id="search">
                        <p:outputPanel>
                            <h:outputText value="Search all fields:" />
                            <p:inputText id="globalFilter" onkeyup="PF('projectsTable').filter()" style="width:150px" placeholder="Enter keyword"/>
                        </p:outputPanel>
                    </f:facet>
                    <p:column filterBy="#{projectList.projectID}">
                        <f:facet name="header">Project ID</f:facet>
                        <p:commandLink value="#{projectList.projectID}" action="#{projectBean.updateProject(projectList)}" />
                    </p:column>
                    <p:column filterBy="#{projectList.projectName}">
                        <f:facet name="header">Project name</f:facet>
                        <h:outputText value="#{projectList.projectName}" />
                    </p:column>
                    <p:column filterBy="#{projectList.startDate}">
                        <f:facet name="header">Start Date</f:facet>
                        <h:outputText value="#{projectList.startDate}" />
                    </p:column>
                    <p:column filterBy="#{projectList.duration}">
                        <f:facet name="header">Duration</f:facet>
                        <h:outputText value="#{projectList.duration}" />
                    </p:column>
                    <p:column filterBy="#{projectList.type.typeName}">
                        <f:facet name="header">Project Type</f:facet>
                        <h:outputText value="#{projectList.type.typeName}" />
                    </p:column>
                    <p:column filterBy="#{projectList.description}">
                        <f:facet name="header">Description</f:facet>
                        <h:outputText value="#{projectList.description}" />
                    </p:column>
                    <p:column>
                        <f:facet name="header">Update</f:facet>
                        <p:commandButton id="selectButton" update=":formUpdate" oncomplete="updateProject.show()" icon="ui-icon-pencil" title="Update" styleClass="ui-priority-primary" >
                            <f:setPropertyActionListener value="#{projectList}" target="#{projectBean.project}"/>
                        </p:commandButton>  
                    </p:column>
                    <p:column>
                        <f:facet name="header">Delete</f:facet>
                        <p:commandButton id="delete" update=":formDelete" oncomplete="deleteProject.show()" icon="ui-icon-trash" title="Delete" styleClass="ui-priority-primary" >
                            <f:setPropertyActionListener value="#{projectList}" target="#{projectBean.project}"/>
                        </p:commandButton>
                    </p:column>
                </p:dataTable>
            </h:form>

            <h:form id="formCreate">
                <p:dialog header="Create Project" widgetVar="createProject" showEffect="explode" 
                          hideEffect="explode" modal="true" resizable="true">
                    <h:panelGrid id="display" columns="3" cellpadding="5" style="margin: 0 auto; " >
                        <p:outputLabel for="projectName" value="Project Name:"  />
                        <p:inputText id="projectName" value="#{projectBean.project.projectName}" 
                                     required="true"  >
                            <f:validateLength minimum="6" maximum="100"/>
                        </p:inputText>
                        <p:message for="projectName"  />

                        <p:outputLabel for="descriptiton" value="Description: "  />
                        <p:inputTextarea id="descriptiton" value="#{projectBean.project.description}"
                                         required="true" cols="42" rows="4" >
                            <f:validateLength minimum="10" />
                        </p:inputTextarea>
                        <p:message for="descriptiton"  />

                        <p:outputLabel for="startDate" value="Start date: "  />
                        <p:calendar id="startDate" value="#{projectBean.project.startDate}" pattern="dd-MM-yyyy" effect="fold" >
                            <f:convertDateTime pattern="dd-MM-yyyy" />
                        </p:calendar>
                        <p:message for="startDate"  />

                        <p:outputLabel for="duration" value="Duration(Day): "  />
                        <p:spinner id="duration" min="1" max="1000" value="#{projectBean.project.duration}"   />
                        <p:message for="duration"  />

                        <p:outputLabel for="projectType" value="Project Type: "  />
                        <h:selectOneMenu id="projectType" value="#{projectBean.project.type}" converter="typeConverter">
                            <f:selectItems value="#{projectBean.types}" var="type"
                                           itemValue="#{type}" itemLabel="#{type.typeName}" />
                        </h:selectOneMenu>
                        <p:message for="projectType"  />

                        <f:facet name="footer">
                            <p:separator />
                            <p:commandButton value="Apply" update=":formDataTable, :growl" oncomplete="PF('createProject').hide()"
                                             icon="ui-icon-circle-check" title="Create" actionListener="#{projectBean.createProject(event)}" />
                            <p:commandButton value="Cancel" onclick="PF('createProject').hide()" icon="ui-icon-circle-close" title="Create" />
                        </f:facet>
                    </h:panelGrid>
                </p:dialog>
            </h:form>

            <h:form id="formDelete">
                <p:confirmDialog id="confirmDialog" message="Do you want delete project? " header="Delete Project" severity="alert"
                                 widgetVar="deleteProject"
                                 showEffect="fade" hideEffect="explode">
                    <h:inputHidden value="#{projectBean.project.projectID}" />
                    <p:commandButton id="confirm" value="Yes" update=":formDataTable, :growl" actionListener="#{projectBean.deleteProject(event)}" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" 
                                     oncomplete="PF('deleteProject').hide()" />
                    <p:commandButton id="cancel" value="No" onclick="PF('deleteProject').hide()" styleClass="ui-confirmdialog-yes" icon="ui-icon-close" type="button" />
                </p:confirmDialog>
            </h:form>

            <h:form id="formUpdate">
                <p:dialog header="Update Project" widgetVar="updateProject" showEffect="explode" 
                          hideEffect="explode" modal="true" resizable="false">
                    <h:panelGrid id="display" columns="3" cellpadding="5" style="margin: 0 auto; " >
                        <h:outputLabel value="Project ID:"  />
                        <p:outputLabel value="#{projectBean.project.projectID}"  />                    
                        <h:inputHidden value="#{projectBean.project.projectID}" />

                        <h:outputLabel for="projectName" value="Project Name:"  />
                        <p:inplace>
                            <p:inputText id="projectName" value="#{projectBean.project.projectName}" required="true"  >
                                <f:validateLength minimum="6" maximum="100"/>
                            </p:inputText>
                        </p:inplace>
                        <p:message for="projectName"/>

                        <h:outputLabel for="descriptiton" value="Description: "  />
                        <p:inplace>
                            <p:inputTextarea id="descriptiton" value="#{projectBean.project.description}"
                                             required="true" cols="42" rows="4" >
                                <f:validateLength minimum="10" />
                            </p:inputTextarea>
                        </p:inplace>
                        <p:message for="descriptiton"/>

                        <h:outputLabel for="startDate" value="Start date: "  />
                        <p:inplace>
                            <p:calendar id="startDate" value="#{projectBean.project.startDate}" pattern="dd-MM-yyyy" 
                                        effect="fold" >
                                <f:convertDateTime pattern="dd-MM-yyyy" />
                            </p:calendar>
                        </p:inplace>
                        <p:message for="startDate"  />

                        <h:outputLabel for="" value="Duration: "  />
                        <p:inplace>
                            <p:spinner id="duration" min="1" max="1000" value="#{projectBean.project.duration}"   />
                        </p:inplace>
                        <p:message for="duration"  />

                        <h:outputLabel for="projectType" value="Project Type: "/>
                        <h:selectOneMenu id="projectType" value="#{projectBean.projectType}" converter="typeConverter">
                            <f:selectItems value="#{projectBean.types}" var="projectType"
                                           itemValue="#{projectType}" itemLabel="#{projectType.typeName}" />
                        </h:selectOneMenu>
                        <p:message for="projectType"  />

                        <f:facet name="footer">
                            <p:separator />
                            <p:commandButton value="Save" update=":formDataTable" oncomplete="PF('updateProject').hide()"
                                             icon="ui-icon-circle-check" title="Save" actionListener="#{projectBean.saveProject()}" />
                            <p:commandButton value="Cancel" onclick="PF('updateProject').hide()" icon="ui-icon-circle-close" title="Create" />
                        </f:facet>
                    </h:panelGrid>
                </p:dialog>
            </h:form>

        </f:view>
    </ui:define>

</ui:composition>
